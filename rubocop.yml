# New Leaders' house style.

# Enable RSpec cops for test files
plugins:
  - rubocop-rails
  - rubocop-rspec
  - rubocop-performance

# Inherit from rubocop-rails-omakase and override specific settings
# COMBAK: maybe we simply tune and drop this dependency altogether?
inherit_gem:
    rubocop-rails-omakase: rubocop.yml

AllCops:
  Exclude:
    - 'bin/*' # Executable scripts
    - 'config.ru' # Rack configuration file
    - 'Rakefile' # Rake tasks file
  NewCops: enable

# Turn on all the default cops - this is counterintuitive since rubocop-rails-omakase
# explicitly disables many cops, but we want to ensure a strict baseline.
# Especially for security-related cops that may be disabled by default.
Bundler:
  Enabled: true
Gemspec:
  Enabled: true
Layout:
  Enabled: true
Lint:
  Enabled: true
Metrics:
  Enabled: true
Naming:
  Enabled: true
Performance:
  Enabled: true
  Exclude:
    - "spec/**/*"
Rails:
  Enabled: true
Security:
  Enabled: true
Style:
  Enabled: true

# --- Layout Cops ---
# These manage code formatting and layout.
Layout/IndentationConsistency:
  Description: 'Ensure consistent indentation throughout the codebase.'
  Enabled: true
  EnforcedStyle: normal

Layout/IndentationWidth:
  Enabled: true
  Width: 2

Layout/LineLength:
  AllowedPatterns: ['^ *# '] # ignore ruby comment lines

# Use `[a, [b, c]]` not `[ a, [ b, c ] ]`
Layout/SpaceInsideArrayLiteralBrackets:
  Enabled: false

# --- Metrics & Performance Cops ---
# These manage code size and performance hints.
# Reasonable but not overly strict limits are set here.
Metrics/AbcSize:
  Max: 25
  Exclude:
    - 'db/**/*.rb'
    - '**/*.rake'

Metrics/BlockLength:
  Description: 'Avoid overly long blocks.'
  Enabled: true
  Exclude:
    - 'Guardfile'
    - 'config/environments/*.rb'
    - 'config/routes.rb'
    - 'db/**/*.rb'
    - '**/*.rake'
    - 'spec/**/*.rb'

Metrics/ClassLength:
  Description: 'Avoid overly long classes.'
  Enabled: true
  Max: 150 # Set a maximum of 150 lines per class (excluding comments/blanks)

Metrics/MethodLength:
  Description: 'Avoid overly long methods for better readability and maintainability.'
  Enabled: true
  Max: 25 # Set a maximum of 25 lines per method
  Exclude:
    - 'db/migrate/*'
    - '**/*.rake'

# --- Naming Cops ---
# These manage naming conventions in the codebase.
Naming/VariableNumber:
  EnforcedStyle: snake_case

# --- Rails Cops ---
# These manage Rails-specific best practices.
Rails/I18nLocaleTexts:
  Enabled: false

Rails/UnknownEnv:
  Environments:
    - development
    - staging
    - test
    - production

# --- RSpec Cops ---
# These manage RSpec testing best practices.
RSpec/ExampleLength:
  Enabled: true
  Max: 20

RSpec/MultipleExpectations:
  Max: 5

RSpec/MultipleMemoizedHelpers:
  Max: 7

RSpec/NestedGroups:
  Enabled: true
  Max: 4

# --- Style Cops ---
# These manage stylistic choices in the codebase.
Style/AsciiComments:
  AllowedChars:
    - ©
    - €

Style/Documentation:
  Enabled: false

Style/StringLiteralsInInterpolation:
  EnforcedStyle: double_quotes